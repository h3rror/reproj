function subs = ind2subs(sizes,ind)

dim = numel(sizes);
prods = zeros(1,dim);
prods(1) = sizes(1);
for i =2:dim
    prods(i) = prods(i-1)*sizes(i);
end

subs = zeros(1,dim);
for i = dim:-1:2
    prod = prods(i-1);
    sub = floor(ind/prod);
    subs(i) = sub;
    ind = ind - prod*sub;
end
subs = subs+1;

subs(1) = ind;

ind2sub


